<html>
<head>
<meta charset='utf-8' />
<meta name="viewport" content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>Flashcards v0.62</title>
<script src="vue.min.js"></script>
<script src="d3.min.js"></script>
</head>
<body>
<div id="app">
        <!--navbar-->
        <h3 style='text-align:center'><span v-on:click="Fresh('prev')">&lt;&lt;</span><input type="text" size="5" v-model="xid" v-on:input="Fresh('curr')" /><span v-on:click="Fresh('next')">&gt;&gt;</span></h3>
        <!--detail and id-->
        <h3 style='width:90%' v-on:click="if (!Showme)Showme=true;else Fresh('rand');"><label v-text="Detail"></label></h3>
        <!--answer-->
        <h2 style='width:90%' v-show="Showme && Disease!=''">
        <span v-on:click="Listdis">{{ Disease }}<br /></span>
        {{ Cat }} {{ Class }}<br />
        {{ Method }}<br />
        <span style="color:rgb(255,30,30)">{{ Rx }}</span><br />
        </h2>
        <h3><span v-html="ldis" v-show="Showldis"></span></h3>
        <p style='color:rgb(200,200,200);text-align:center'>by jiamin</p>

    </div>

    <script src="Content/vue/dist/vue.js"></script>
    <script type="text/javascript">
    function rang(min,max){
    var cur=max-min+1;
    return Math.floor(Math.random()*cur+min);
    }
    var ddd;
    d3.csv("ddd", function(dd) {console.log(dd);ddd=dd});
    //Model
    var data = {
        Detail: '点击开始!',
        Disease: '',
        Class: '',
        Method: '',
        Rx: '',
        Cat: '',
        ldis:'',
        Showme: true,
        Showldis: false,
        xid: 0,
    }

    //ViewModel
    var vue = new Vue({
        el: '#app',
        data: data,
        methods: {
            Fresh: function (action) {
                // `this` 在方法里指当前 Vue 实例
                //alert('Next ' + this.Detail + '!');
                if (action=='next')
                this.xid++;
                else if (action=='prev')
                this.xid--;
                else if (action=='rand')
                this.xid=rang(1,ddd.length-1);
                if (this.xid>ddd.length-1)
                this.xid=1;
                else if (this.xid<1)
                this.xid=ddd.length-1
                this.Showme=false;
                this.Showldis=false;
                this.Detail=ddd[this.xid].detail;
                this.Disease=ddd[this.xid].disease;
                this.Class=ddd[this.xid].classi;
                this.Cat=ddd[this.xid].cat;
                this.Method=ddd[this.xid].method;
                this.Rx=ddd[this.xid].rx;  
            },
            Listdis: function(){
                this.Showldis=true;
                var ox='';
                for (var i=1; i<ddd.length; i++){
                    if (ddd[i].disease==this.Disease) ox=ox+ '<li>' + ddd[i].cat + ' ' + ddd[i].classi + '-' + ddd[i].rx + '</li>';
                }
                this.ldis=ox;
            }
        }
    });
    </script>
</body>
</html>
